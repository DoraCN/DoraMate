# 07 文件与 YAML 体验

## 1. 文件操作模型

### 1.1 核心操作对象

在 DoraMate 中，用户的直接操作对象是 **Flow**，而非 YAML 文件本身。

- Flow 是一组节点与连线所构成的可执行结构
- YAML 仅作为 Flow 的存储与交换格式存在
- UI 层面不要求用户直接编辑或理解 YAML 内容

---

### 1.2 基础文件操作

系统提供以下基础文件操作：

- **New**
  - 清空当前画布
  - 创建一个新的空 Flow
- **Open**
  - 从本地文件系统加载 YAML
  - 将 YAML 解析为可视化节点图
- **Save**
  - 将当前画布状态保存为 YAML
  - 覆盖当前 Flow 文件
- **Recent**
  - 显示最近打开的 Flow 列表
  - 用于快速恢复工作状态

所有文件操作均基于本地文件系统完成，不涉及账号或云端同步。

---

## 2. YAML 导入体验

### 2.1 导入行为定义

YAML 导入的本质是：

> 将已有的 YAML 文件 **还原为一张可视化 Flow 图**

导入过程包括：

1. 读取本地 YAML 文件
2. 解析结构并生成对应节点
3. 在画布中自动布局节点与连线

---

### 2.2 导入失败的处理

当 YAML 无法被成功解析时：

- 不生成任何节点或连线
- 保持画布原有状态不变
- 在画布或工具栏中给出失败提示

失败提示应至少包含：

- 导入失败的原因类型（如结构不合法、节点类型未知）
- 可通过画布定位的问题区域（如存在）

V1.0 阶段不要求对 YAML 错误进行逐行解释。

---

## 3. YAML 导出体验

### 3.1 导出行为定义

YAML 导出用于：

- 保存当前 Flow
- 将 Flow 交由系统执行
- 作为 Flow 的复用与迁移方式

导出行为本质为：

> 将当前画布中的节点结构 **序列化为 YAML**

---

### 3.2 导出约束

- YAML 作为中间产物存在
- UI 中不展示系统路径或内部存储结构
- 导出操作不要求用户进行额外配置

用户只需确认“保存”这一行为，而不需要理解 YAML 内容。

---

## 4. 最近文件与工作连续性

### 4.1 最近文件列表

最近文件列表用于提升连续使用体验：

- 按最近打开时间排序
- 仅展示 Flow 名称与更新时间
- 点击后直接加载对应 Flow

---

### 4.2 未保存状态提示

当用户尝试以下操作时：

- New
- Open 其他 Flow
- 关闭页面

若当前 Flow 存在未保存修改：

- 系统应进行提示
- 提供保存 / 放弃修改的选择

---

## 5. 用户心智模型与设计约束

### 5.1 心智模型定义

在 DoraMate 中：

- 用户认为自己“在搭一个 Flow”
- 而不是“在编辑一个 YAML 文件”

因此：

- UI 以节点与连线为核心
- YAML 相关操作被收敛在工具栏或文件菜单中
- 不鼓励用户直接接触 YAML 细节

---

### 5.2 对 UI 设计的约束

基于上述心智模型：

- 不在主界面展示 YAML 内容
- 不要求用户为 YAML 配置路径或参数
- 不将 YAML 错误直接暴露为技术错误信息

YAML 是系统实现细节，而非用户操作对象。

---

## 6. 设计目标总结

- 文件操作直观、符合本地工具习惯
- YAML 使用被尽量“隐藏”在系统内部
- 用户始终围绕 Flow 进行操作
- 不因底层格式暴露而增加学习成本
